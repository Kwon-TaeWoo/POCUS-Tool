<Window x:Class="POCUS.ROSC.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:oxy="http://oxyplot.org/wpf"
        Title="POCUS-CAC GUI 1.00" Height="1080" Width="1920" 
        MinHeight="1080" MinWidth="1920"
        Background="Black" Foreground="White"
        WindowStartupLocation="CenterOwner" WindowState="Maximized">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="970*"/>
            <ColumnDefinition Width="600*" MinWidth="600"/>
        </Grid.ColumnDefinitions>

        <!-- 좌측 패널: Command Frame -->
        <Grid x:Name="gridCommandPanel" Grid.Column="0" Background="#303030">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- 테두리 -->
            <Border Grid.Row="0" Grid.RowSpan="6" BorderBrush="#404040" BorderThickness="1"/>
            
            <!-- 헤더 -->
            <TextBlock Grid.Row="0" Text="ROSC-CAC GUI" 
                      Style="{StaticResource HeaderTextBlock}"
                      Margin="0,20,0,20"/>

            <!-- CheckBox 섹션 -->
            <StackPanel Grid.Row="1" Margin="0,0,0,0" HorizontalAlignment="Center">
                <!-- 첫 번째 행 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <CheckBox x:Name="cbAutoCalc" Content="Auto Calc" 
                             Width="150" IsChecked="True" Margin="0,0,10,0" 
                             Style="{StaticResource DefaultCheckBox}"/>
                    <CheckBox x:Name="cbAutoROI" Content="Auto ROI" 
                             Width="150" IsChecked="True"
                             Style="{StaticResource DefaultCheckBox}"/>
                </StackPanel>

                <!-- 두 번째 행 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <CheckBox x:Name="cbAutoSave" Content="Auto Save" 
                             Width="150" IsChecked="True" Margin="0,0,10,0"
                             Style="{StaticResource DefaultCheckBox}"/>
                    <CheckBox x:Name="cbAutoFolder" Content="Auto Folder" 
                             Width="150" IsChecked="True"
                             Style="{StaticResource DefaultCheckBox}"/>
                </StackPanel>

                <!-- 세 번째 행 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <CheckBox x:Name="cbSmallModel" Content="Lightweight Model" 
                             Width="150" IsChecked="True" Margin="0,0,10,0"
                             Style="{StaticResource DefaultCheckBox}"/>
                    <CheckBox x:Name="cbDrawEllipse" Content="Draw Ellipse" 
                             Width="150" IsChecked="True"
                             Style="{StaticResource DefaultCheckBox}"/>
                </StackPanel>

                <!-- 네 번째 행 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <CheckBox x:Name="cbPythonInference" Content="Python Inference" 
                             Width="150" IsChecked="False" Margin="0,0,10,0" IsEnabled="False"
                             Style="{StaticResource DefaultCheckBox}"/>
                    <CheckBox x:Name="cbPerformanceMode" Content="Performance Mode" 
                             Width="150" IsChecked="True"
                             Style="{StaticResource DefaultCheckBox}"/>
                </StackPanel>
            </StackPanel>

            <!-- 버튼 섹션 -->
            <StackPanel Grid.Row="2" Margin="0,0,0,20" HorizontalAlignment="Center">
                <Button x:Name="btnConnectHDMI" Content="Connect HDMI" 
                       Width="300" Height="50" Margin="0,0,0,15"
                       Style="{StaticResource PrimaryButton}"
                       IsEnabled="False"
                       Click="BtnConnectHDMI_Click"/>

                <Button x:Name="btnLoadVideo" Content="Load Video" 
                       Width="300" Height="50" Margin="0,0,0,15"
                       Style="{StaticResource PrimaryButton}"
                       IsEnabled="False"
                       Click="BtnLoadVideo_Click"/>

                <Button x:Name="btnPlay" Content="Play" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnPlay_Click"/>

                <Button x:Name="btnCalculateCAC" Content="Calculate" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnCalculateCAC_Click"/>

                <Button x:Name="btnSetROI" Content="Set ROI" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnSetROI_Click"/>

                <Button x:Name="btnExportVideo" Content="Export Video" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnExportVideo_Click"/>

                <Button x:Name="btnExportImage" Content="Export Image" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnExportImage_Click"/>

                <Button x:Name="btnExportExcel" Content="Export Excel" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnExportExcel_Click"/>

                <Button x:Name="btnCompareInference" Content="Compare Inference" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       Click="BtnCompareInference_Click"/>

                <Button x:Name="btnSelectModel" Content="Select Model File" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       Click="BtnSelectModel_Click"/>

                <Button x:Name="btnConvertToOnnx" Content="Convert PTH to ONNX" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False"
                       Click="BtnConvertToOnnx_Click"/>

                <Button x:Name="btnCheckCUDA" Content="Check CUDA Status" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False" Visibility="Collapsed"
                       Click="BtnCheckCUDA_Click"/>

                <Button x:Name="btnViewLogs" Content="View Logs" 
                       Style="{StaticResource PrimaryButton}"
                       Width="300" Height="50" Margin="0,0,0,15"
                       IsEnabled="False" Visibility="Collapsed"
                       Click="BtnViewLogs_Click"/>
            </StackPanel>

            <!-- Status Display -->
            <Border Grid.Row="3" Background="#FF2D2D30" 
                   CornerRadius="5" 
                   Margin="25,0,25,10" 
                   Padding="15,10">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Ellipse x:Name="statusIndicator" 
                            Style="{StaticResource StatusIndicator}"/>
                    <TextBlock x:Name="statusText" 
                              Text="Initializing..." 
                              Style="{StaticResource StatusTextBlock}"/>
                </StackPanel>
            </Border>

            <!-- Progress Bar -->
            <ProgressBar Grid.Row="4" x:Name="progressBar" 
                        Height="30" Margin="25,0,25,0"
                        Visibility="Collapsed"
                        IsIndeterminate="True"/>
        </Grid>

        <!-- 중앙 패널: Data Frame -->
        <Grid x:Name="gridDataPanel" Grid.Column="1" Background="Black">
            <!-- 테두리 -->
            <Border BorderBrush="#404040" BorderThickness="1"/>
            
            <Grid>
                <Image x:Name="imageDisplay" 
                      Stretch="Uniform" 
                      HorizontalAlignment="Center" 
                      VerticalAlignment="Center"/>

                <!-- ROI 선택을 위한 Canvas 오버레이 -->
                <Canvas x:Name="roiCanvas" 
                       Background="Transparent" 
                       Visibility="Collapsed"
                       MouseLeftButtonDown="RoiCanvas_MouseLeftButtonDown"
                       MouseMove="RoiCanvas_MouseMove"
                       MouseLeftButtonUp="RoiCanvas_MouseLeftButtonUp">
                    <Rectangle x:Name="roiRectangle" 
                              Stroke="Green" 
                              StrokeThickness="2" 
                              Fill="Transparent"
                              Visibility="Collapsed"/>
                </Canvas>
            </Grid>
        </Grid>

        <!-- 우측 패널: Measure & Graph Frame -->
        <Grid x:Name="gridMeasureGraph" Grid.Column="2" Background="#303030">
            <Grid.RowDefinitions>
                <RowDefinition Height="20"/>
                <RowDefinition Height="60"/>
                <RowDefinition Height="960*" MinHeight="960"/>
                <RowDefinition Height="20"/>
            </Grid.RowDefinitions>

            <!-- 테두리 -->
            <Border Grid.Row="0" Grid.RowSpan="4" BorderBrush="#404040" BorderThickness="1"/>

            <!-- 측정값 표시 영역 -->
            <Grid x:Name="gridMeasure" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Top">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
            
                <!-- 측정값 표시 -->
                <Border Style="{StaticResource MeasurementCard}" Grid.Column="0" Margin="0,0,5,0">
                    <TextBlock x:Name="labelMeasureROSC" Text="ROSC Status" Style="{StaticResource MeasurementTextBlock}" Foreground="Yellow"/>
                </Border>
                <Border Style="{StaticResource MeasurementCard}" Grid.Column="1" Margin="5,0,0,0">
                    <TextBlock x:Name="labelMeasureCAC" Text="CAC: 0.00" Style="{StaticResource MeasurementTextBlock}"/>
                </Border>
            </Grid>

            <!-- 그래프 영역 -->
            <Grid x:Name="gridGraph" Grid.Row="2" Margin="20,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="450*"/>
                    <RowDefinition Height="450*"/>
                </Grid.RowDefinitions>
                <!-- CAC 그래프 -->
                <oxy:PlotView x:Name="cacGraph" Grid.Row="0" Margin="0,10" Background="Black" />
                
                <!-- ABP 예측 그래프 -->
                <oxy:PlotView x:Name="abpGraph" Grid.Row="1" Margin="0,10" Background="Black" />
            </Grid>
        </Grid>
    </Grid>
</Window>
